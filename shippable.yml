language: php

php:
  - 5.4
  - 5.5
  - 5.6

before_install:
  - composer selfupdate
  - npm install bower

install:
  - composer install --no-interaction --prefer-dist --no-progress
  - bower install

before_script:
  - mkdir -p shippable/codecoverage
  - mkdir -p shippable/testresults
  - mysql -u root -e 'create database blog_mysql;'
  - php www/index.php -u root -n blog_mysql

script:
  - vendor/bin/tester tests -p php -s -c tests/php-unix.ini -o junit > ./shippable/testresults/junit.xml

after_failure:
  - vendor/bin/tester tests -p php -s -c tests/php-unix.ini --info
  - cat app/config/config.local.neon;
  - for i in $(find tests -name \*.actual); do echo "--- $i"; cat $i; echo; echo; done

notifications:
  email: false
